"use strict";exports.id=36,exports.ids=[36],exports.modules={51040:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function a(e){try{u(i.next(e))}catch(e){r(e)}}function s(e){try{u(i.throw(e))}catch(e){r(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((i=i.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.t=t.initI18n=t.NAV_CONFIG_NS=t.SMART_LINKS_NS=void 0;const r=o(n(35107)),a=o(n(53636)),s=o(n(65026));function u(){return i(this,void 0,void 0,(function*(){yield r.default.init({resources:{en:{[t.SMART_LINKS_NS]:a.default,[t.NAV_CONFIG_NS]:s.default}},lng:"en",fallbackLng:"en",defaultNS:t.SMART_LINKS_NS,ns:[t.SMART_LINKS_NS,t.NAV_CONFIG_NS]})}))}t.SMART_LINKS_NS="app-config-writer:smartLinksConfig",t.NAV_CONFIG_NS="app-config-writer:navConfig",t.initI18n=u,t.t=function(e,t){return r.default.t(e,t)},u().catch((()=>{}))},72089:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generateInboundNavigationConfig=t.generateSmartLinksConfig=t.promptInboundNavigationConfig=t.getSmartLinksTargetFromPrompt=void 0;var i=n(45647);Object.defineProperty(t,"getSmartLinksTargetFromPrompt",{enumerable:!0,get:function(){return i.getSmartLinksTargetFromPrompt}}),Object.defineProperty(t,"promptInboundNavigationConfig",{enumerable:!0,get:function(){return i.promptInboundNavigationConfig}});var o=n(98929);Object.defineProperty(t,"generateSmartLinksConfig",{enumerable:!0,get:function(){return o.generateSmartLinksConfig}});var r=n(46379);Object.defineProperty(t,"generateInboundNavigationConfig",{enumerable:!0,get:function(){return r.generateInboundNavigationConfig}})},46379:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function a(e){try{u(i.next(e))}catch(e){r(e)}}function s(e){try{u(i.throw(e))}catch(e){r(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.readManifest=t.generateInboundNavigationConfig=void 0;const o=n(14774),r=n(5407),a=n(84659),s=n(50911),u=n(71017),l=n(51040);function c(e,t){return i(this,void 0,void 0,(function*(){const n=(0,u.join)(yield(0,o.getWebappPath)(e),o.FileName.Manifest),i=t.readJSON(n);if(!i)throw Error((0,l.t)("error.manifestNotFound",{path:n,ns:l.NAV_CONFIG_NS}));if(!i["sap.app"])throw Error((0,l.t)("error.sapAppNotDefined",{ns:l.NAV_CONFIG_NS}));return{manifest:i,manifestPath:n}}))}t.generateInboundNavigationConfig=function(e,{semanticObject:t,action:n,title:o,subTitle:u},d=!1,f){var p,g,m;return i(this,void 0,void 0,(function*(){f||(f=(0,a.create)((0,r.create)()));const{manifest:i,manifestPath:v}=yield c(e,f),y=`${t}-${n}`;if(!d&&(null===(p=i["sap.app"].crossNavigation)||void 0===p?void 0:p.inbounds[y]))throw Error((0,l.t)("error.inboundExists",{inboundKey:y,ns:l.NAV_CONFIG_NS}));const h={[y]:{semanticObject:t,action:n,title:o,subTitle:u,signature:{parameters:{},additionalParameters:"allowed"}}},b=Object.assign(null!==(g=i["sap.app"].crossNavigation)&&void 0!==g?g:{},{inbounds:(0,s.mergeObjects)(null===(m=i["sap.app"].crossNavigation)||void 0===m?void 0:m.inbounds,h)});return f.extendJSON(v,{"sap.app":Object.assign(i["sap.app"],{crossNavigation:b})}),f}))},t.readManifest=c},45647:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.promptInboundNavigationConfig=t.promptUserPass=t.getSmartLinksTargetFromPrompt=void 0;var i=n(56172);Object.defineProperty(t,"getSmartLinksTargetFromPrompt",{enumerable:!0,get:function(){return i.getSmartLinksTargetFromPrompt}}),Object.defineProperty(t,"promptUserPass",{enumerable:!0,get:function(){return i.promptUserPass}});var o=n(56513);Object.defineProperty(t,"promptInboundNavigationConfig",{enumerable:!0,get:function(){return o.promptInboundNavigationConfig}})},56513:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function a(e){try{u(i.next(e))}catch(e){r(e)}}function s(e){try{u(i.throw(e))}catch(e){r(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.promptInboundNavigationConfig=void 0;const o=n(70708),r=n(51040),a=n(5407),s=n(84659),u=n(46379);function l(e,t,n=0){return 0===(null==e?void 0:e.trim().length)?(0,r.t)("prompt.validationWarning.inputRequired",{inputName:t,ns:r.NAV_CONFIG_NS}):!(n&&e.length>n)||(0,r.t)("prompt.validationWarning.maxLength",{maxLength:n,ns:r.NAV_CONFIG_NS})}t.promptInboundNavigationConfig=function(e){var t,n;return i(this,void 0,void 0,(function*(){const i=(0,s.create)((0,a.create)()),{manifest:c}=yield(0,u.readManifest)(e,i),d=null===(n=null===(t=null==c?void 0:c["sap.app"])||void 0===t?void 0:t.crossNavigation)||void 0===n?void 0:n.inbounds;let f=yield(0,o.prompt)(function(e){const t=(0,r.t)("prompt.message.semanticObject",{ns:r.NAV_CONFIG_NS}),n=(0,r.t)("prompt.message.action",{ns:r.NAV_CONFIG_NS}),i=(0,r.t)("prompt.message.title",{ns:r.NAV_CONFIG_NS});return[{name:"semanticObject",type:"text",message:t,format:e=>null==e?void 0:e.trim(),validate:e=>l(e,t,30)},{name:"action",type:"text",message:n,format:e=>null==e?void 0:e.trim(),validate:e=>l(e,n,60)},{type:(t,n)=>e.indexOf(`${n.semanticObject}-${n.action}`)>-1&&"confirm",name:"overwrite",message:(0,r.t)("prompt.message.overwrite",{ns:r.NAV_CONFIG_NS}),initial:!1},{name:"title",type:(e,t)=>!1!==t.overwrite&&"text",message:i,format:e=>null==e?void 0:e.trim(),validate:e=>l(e,i)},{name:"subTitle",type:(e,t)=>!1!==t.overwrite&&"text",message:(0,r.t)("prompt.message.subtitle",{ns:r.NAV_CONFIG_NS}),format:e=>null==e?void 0:e.trim()}]}(Object.keys(null!=d?d:{})));return!1===(null==f?void 0:f.overwrite)&&(f=void 0),""===(null==f?void 0:f.subTitle)&&(f.subTitle=void 0),{config:f,fs:i}}))}},56172:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function a(e){try{u(i.next(e))}catch(e){r(e)}}function s(e){try{u(i.throw(e))}catch(e){r(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getSmartLinksTargetFromPrompt=t.promptUserPass=void 0;const o=n(48009),r=n(70708),a=n(14425),s=n(14774),u=n(51040),l=n(98929),c=n(71432),d=(e,t)=>!(!e||!e.trim())||(0,u.t)(t),f=e=>{const t=[];return(0,a.isAppStudio)()&&((e,t)=>{((null==t?void 0:t.destination)||(null==t?void 0:t.url))&&e.push({name:(null==t?void 0:t.destination)?c.TargetType.destination:c.TargetType.url,message:(0,u.t)("questions.useTarget",{target:t.destination||t.url}),type:"confirm",initial:!0,format:e=>e?t.destination||t.url:e}),e.push({name:"select",type:e=>e?null:"select",message:(0,u.t)("questions.target"),choices:[{title:(0,u.t)("questions.enter",{type:c.TargetType.destination}),value:c.TargetType.destination},{title:(0,u.t)("questions.enter",{type:c.TargetType.url}),value:c.TargetType.url}]}),e.push({type:e=>e===c.TargetType.destination?"text":null,name:c.TargetType.destination,initial:null==t?void 0:t.destination,message:(0,u.t)("questions.target",{type:c.TargetType.destination,file:(null==t?void 0:t.destination)?`(${s.FileName.UI5DeployYaml})`:""}),validate:e=>d(e,"error.target")})})(t,e),t.push({type:e=>e&&e!==c.TargetType.url?null:"text",name:c.TargetType.url,initial:null==e?void 0:e.url,message:(0,u.t)("questions.target",{type:c.TargetType.url,file:(null==e?void 0:e.url)?`(${s.FileName.UI5DeployYaml})`:""}),validate:e=>d(e,"error.target")},{name:"client",type:(e,t)=>(null==t?void 0:t.url)?"text":null,initial:null==e?void 0:e.client,message:(0,u.t)("questions.client",{file:(null==e?void 0:e.client)?`(${s.FileName.UI5DeployYaml})`:""}),format:e=>"number"==typeof e?e.toString():e}),t};function p(e){return i(this,void 0,void 0,(function*(){const{username:t,password:n}=yield(0,r.prompt)([{type:"text",name:"username",message:`${(0,o.cyan)((0,u.t)("info.username"))}`,validate:e=>!(!e||!e.trim())||`${(0,u.t)("error.emptyUsername")}`},{type:"invisible",name:"password",message:`${(0,o.cyan)((0,u.t)("info.password"))}`,validate:e=>!(!e||!e.trim())||`${(0,u.t)("error.emptyPassword")}`}],{onCancel:()=>(null==e||e.info((0,o.yellow)((0,u.t)("info.operationAborted"))),process.exit(1))});return{username:t,password:n}}))}t.promptUserPass=p,t.getSmartLinksTargetFromPrompt=function(e,t){return i(this,void 0,void 0,(function*(){const n=yield(0,l.getTargetDefinition)(e,t),s=yield((e,t)=>i(void 0,void 0,void 0,(function*(){const n={onCancel:()=>(null==t||t.info((0,o.yellow)((0,u.t)("info.operationAborted"))),process.exit(1))},i=f(null==e?void 0:e.target),{url:a,client:s,destination:l}=yield(0,r.prompt)(i,n);return{url:a,client:s,destination:l}})))(n,t),c=yield function(e,t){return i(this,void 0,void 0,(function*(){if((0,a.isAppStudio)()&&e.destination){const n=yield(0,a.listDestinations)(),i=null==n?void 0:n[e.destination];if("NoAuthentication"===(null==i?void 0:i.Authentication))return null==t||t.info((0,u.t)("info.credentialsRequired")),yield p(t);if(i)return void(null==t||t.info((0,u.t)("info.credentialsAvailable")))}else if(e.url){const n=yield(0,l.getLocalStoredCredentials)(e.url,e.client,t);if(null==n?void 0:n.username){const e=[{title:`Use ${n.username}`,value:n},{title:(0,u.t)("questions.credentialsDescription"),value:!1}],{credentials:t}=yield(0,r.prompt)([{name:"credentials",type:"select",message:(0,u.t)("questions.credentials"),choices:e,initial:0}]);if(t)return t}}return p(t)}))}(s,t);return{target:s,auth:c,ignoreCertErrors:null==n?void 0:n.ignoreCertErrors}}))}},52372:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function a(e){try{u(i.next(e))}catch(e){r(e)}}function s(e){try{u(i.throw(e))}catch(e){r(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.generateSmartLinksConfig=void 0;const o=n(5407),r=n(84659),a=n(33995);t.generateSmartLinksConfig=function(e,t,n,s){return i(this,void 0,void 0,(function*(){return s||(s=(0,r.create)((0,o.create)())),yield(0,a.writeSmartLinksConfig)(e,t,s,n),s}))}},98929:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,o)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.getLocalStoredCredentials=t.getTargetDefinition=void 0,o(n(52372),t);var r=n(33995);Object.defineProperty(t,"getTargetDefinition",{enumerable:!0,get:function(){return r.getTargetDefinition}}),Object.defineProperty(t,"getLocalStoredCredentials",{enumerable:!0,get:function(){return r.getLocalStoredCredentials}})},61318:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function a(e){try{u(i.next(e))}catch(e){r(e)}}function s(e){try{u(i.throw(e))}catch(e){r(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.addUi5YamlServeStaticMiddleware=t.readUi5DeployConfigTarget=void 0;const o=n(71017),r=n(14774),a=n(51040),s=n(71432);t.readUi5DeployConfigTarget=function(e){var t;return i(this,void 0,void 0,(function*(){const n=(yield(0,r.readUi5Yaml)(e,r.FileName.UI5DeployYaml)).findCustomTask(s.DeployConfig.DeployToAbap);if(!(null===(t=null==n?void 0:n.configuration)||void 0===t?void 0:t.target))throw Error((0,a.t)("error.noTarget",{file:`(${r.FileName.UI5DeployYaml})`}));const{target:i,ignoreCertError:o}=(null==n?void 0:n.configuration)||{};return{target:i,ignoreCertErrors:o}}))};const u=(e,t)=>{const n={path:"/appconfig",src:"appconfig",fallthrough:!1};if(e.find((e=>e.path===n.path&&e.src===n.src)))return;const i=[...e,n],o=t?{beforeMiddleware:"fiori-tools-proxy"}:{afterMiddleware:"compression"};return Object.assign(Object.assign({name:"fiori-tools-servestatic"},o),{configuration:{paths:i}})};t.addUi5YamlServeStaticMiddleware=function(e,t,n){return i(this,void 0,void 0,(function*(){const i=[r.FileName.Ui5Yaml,r.FileName.Ui5MockYaml,r.FileName.Ui5LocalYaml];for(const a of i){let i;try{i=yield(0,r.readUi5Yaml)(e,a)}catch(e){null==n||n.debug(`File ${a} not existing`);continue}const l=!!i.findCustomMiddleware(s.DeployConfig.FioriToolsProxy),c=i.findCustomMiddleware(s.DeployConfig.FioriToolsServestatic),d=u((null==c?void 0:c.configuration.paths)||[],l);if(d){const n=i.updateCustomMiddleware(d).toString();t.write((0,o.join)(e,a),n)}}}))}},33995:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function a(e){try{u(i.next(e))}catch(e){r(e)}}function s(e){try{u(i.throw(e))}catch(e){r(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.writeSmartLinksConfig=t.getTargetMappingsConfig=t.getTargetDefinition=t.sendRequest=t.getLocalStoredCredentials=void 0;const o=n(48009),r=n(69288),a=n(71017),s=n(62637),u=n(14425),l=n(14774),c=n(20034),d=n(51040),f=n(34158),p=n(61318),g={so:"*",action:"*",systemAliasesFormat:"object","sap-language":"EN",shellType:"FLP",depth:0};function m(e,t){return i(this,void 0,void 0,(function*(){const n=(0,u.isAppStudio)()&&e.target.destination?e.target.destination:e.target.url;if(!n)throw Error((0,d.t)("error.target"));try{const i=function(e){const{target:t,auth:n,ignoreCertErrors:i}=e;let o;return(0,u.isAppStudio)()&&t.destination?(o=(0,s.createForDestination)({auth:n},{Name:t.destination}),delete o.defaults.params.saml2):o=(0,s.createForAbap)({baseURL:t.url,auth:n,ignoreCertErrors:i,params:t.client?{"sap-client":t.client}:void 0}),o}(e);null==t||t.info(`${(0,o.cyan)((0,d.t)("info.connectTo"))} ${n}`);const r=yield i.get("/sap/bc/ui2/start_up",{params:g});return null==t||t.info((0,o.cyan)((0,d.t)("info.connectSuccess"))),JSON.parse(r.data)}catch(e){throw null==t||t.debug(e),Error(e.message)}}))}function v(e,t){return i(this,void 0,void 0,(function*(){const n=yield function(e,t){return i(this,void 0,void 0,(function*(){const n=yield m(e,t);if(!n||!n.targetMappings)throw Error((0,d.t)("error.noTarget"));return n.targetMappings}))}(e,t),o={};for(const e in n){const t=n[e];o[e]={semanticObject:t.semanticObject,action:t.semanticAction,title:t.text,signature:Object.assign({additionalParameters:"ignored",parameters:{}},t.signature),resolutionResult:{}}}return o}))}t.getLocalStoredCredentials=function(e,t,n){return i(this,void 0,void 0,(function*(){try{const i=yield(0,c.getService)({logger:n,entityName:"system"}),o=yield i.read(new c.BackendSystemKey({url:e,client:t}));return(null==o?void 0:o.username)?{username:o.username,password:o.password||""}:void 0}catch(e){null==n||n.warn((0,d.t)("warnings.useCredentialsFailed")),null==n||n.debug(e)}}))},t.sendRequest=m,t.getTargetDefinition=function(e,t){return i(this,void 0,void 0,(function*(){null==t||t.info((0,d.t)("info.searchTarget",{file:l.FileName.UI5DeployYaml}));try{const n=yield(0,p.readUi5DeployConfigTarget)(e);return null==t||t.info((0,o.cyan)((0,d.t)("info.targetFound",{file:l.FileName.UI5DeployYaml}))),n}catch(e){return null==t||t.warn(e.message),void(null==t||t.debug(e))}}))},t.getTargetMappingsConfig=v,t.writeSmartLinksConfig=function(e,t,n,o){return i(this,void 0,void 0,(function*(){let i=yield v(t,o);const s=(0,f.getTemplatePath)("smartlinks-config/fioriSandboxConfig.json"),u=(0,a.join)(e,"appconfig","fioriSandboxConfig.json");if(n.exists(u)){i=function(e,t,n){var i,o,r,a;const s=null===(a=null===(r=null===(o=null===(i=n.readJSON(e).services)||void 0===i?void 0:i.ClientSideTargetResolution)||void 0===o?void 0:o.adapter)||void 0===r?void 0:r.config)||void 0===a?void 0:a.inbounds;return s?(Object.entries(t).forEach((([e,t])=>{s[e]=t})),s):t}(u,i,n);const e=(0,r.render)(n.read(s),{inboundTargets:i},{});n.extendJSON(u,JSON.parse(e))}else n.copyTpl(s,u,{inboundTargets:i});yield(0,p.addUi5YamlServeStaticMiddleware)(e,n,o)}))}},34158:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getTemplatePath=void 0;const i=n(71017);t.getTemplatePath=function(e=""){return(0,i.join)(__dirname,"../templates",e)}},71432:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,o)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(38144),t)},38144:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TargetType=t.DeployConfig=void 0,function(e){e.DeployToAbap="deploy-to-abap",e.FioriToolsProxy="fiori-tools-proxy",e.FioriToolsServestatic="fiori-tools-servestatic"}(t.DeployConfig||(t.DeployConfig={})),function(e){e.destination="destination",e.url="url"}(t.TargetType||(t.TargetType={}))},65026:e=>{e.exports=JSON.parse('{"error":{"sapAppNotDefined":"Manifest is missing required section \'sap.app\'","manifestNotFound":"Manifest not found at path: {{- path}}","inboundExists":"Inbound definition already exists for key: {{inboundKey}}"},"prompt":{"validationWarning":{"inputRequired":"{{inputName}} input is required","maxLength":"Maximum length: {{maxLength}} characters"},"message":{"semanticObject":"Semantic Object","action":"Action","title":"Title","subtitle":"Subtitle (optional)","overwrite":"Overwrite existing config"}}}')},53636:e=>{e.exports=JSON.parse('{"questions":{"enter":"Enter {{-type}}","useTarget":"Do you want to use {{-target}}","target":"SmartLinks configuration source {{-type}} {{-file}}","client":"SAP client {{-file}}","credentials":"Credentials to be used","credentialsDescription":"Provide username and password"},"warnings":{"useCredentialsFailed":"Retrieving stored credentials failed."},"info":{"username":"Username","password":"Password","searchTarget":"Searching for deploy target definition {{-file}}","targetFound":"Deploy target definition found {{-file}}","credentialsAvailable":"Credentials taken from stored system","credentialsRequired":"Credentials are required. Please enter your credentials below","authNeeded":"Credentials might be required. Do you want to enter your credentials?","operationAborted":"Operation aborted by the user.","connectTo":"Connecting to","connectSuccess":"Connection successful"},"error":{"target":"Please provide a target for configuration","noTarget":"No target definition found {{-file}}","emptyUsername":"Username can not be empty.","emptyPassword":"Password can not be empty."}}')}};